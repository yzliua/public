var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{l(i.next(t))}catch(e){r(e)}}function s(t){try{l(i["throw"](t))}catch(e){r(e)}}function l(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}l((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;l;)try{if(o=1,r&&(a=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,r=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(a=l.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){l.label=n[1];break}if(6===n[0]&&l.label<a[1]){l.label=a[1],a=n;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(n);break}a[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(i){n=[6,i],r=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,a,s,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},WordInfo;!function(t){t[t.a=0]="a",t[t.c=1]="c",t[t.f=2]="f",t[t.g=3]="g",t[t.i=4]="i",t[t.o=5]="o",t[t.p=6]="p",t[t.r=7]="r",t[t.t=8]="t",t[t.w=9]="w",t[t.x=10]="x"}(WordInfo||(WordInfo={}));var Game2=function(t){function e(){var e=t.call(this)||this;return e.questionInfo=[{id:0,rightStr:"cat",wrongStr:"pig"},{id:1,rightStr:"cow",wrongStr:"pig"},{id:2,rightStr:"fox",wrongStr:"cat"},{id:3,rightStr:"pig",wrongStr:"cat"}],e.questionList=[],e.moveStep=5,e.optDelay=600,e.lastIdx=0,e.skinName=skins.Game2Skin,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),DragonBone.create("game2_qingwa","bg",{parent:this.group_bg,animation:"normal"}),this.frog=DragonBone.create("game2_qingwa","wawa",{parent:this.group_frog,animation:"normal"}),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this),this.startGame()},e.prototype.clean=function(){Music.playBg("city"),egret.stopTick(this.loop,this)},e.prototype.initQuestion=function(){this.questionList=[];for(var t=0,e=this.questionInfo;t<e.length;t++){for(var n=e[t],i=n.rightStr.split(""),o=[],r=0,a=i;r<a.length;r++){var s=a[r];o.push(WordInfo[s])}for(var l=n.wrongStr.split(""),h=[],u=0,c=l;u<c.length;u++){var s=c[u];h.push(WordInfo[s])}this.questionList.push({id:n.id,rightList:o,wrongList:h})}},e.prototype.nextQuestion=function(){var t=this;if(this.twg_question_in.play(0),this.twg_question_in.stop(),this.word0.onReset(),this.word1.onReset(),this.word2.onReset(),this.group_view.removeChildren(),this.questionIdx==this.questionList.length)return GFunction.removeFromParent(this),void Manager.city.play2();this.lab_question_idx.textFlow=TextManager.changeTxtStyle("("+(this.questionIdx+1)+")/4",{textColor:16736325});var e=this.questionList[this.questionIdx];this.img_question.source="game2_q"+e.id+"_png",Music.play("game2_q"+e.id).then(function(){Music.play("game1_q"+e.id)}),this.touchChildren=!1,this.twg_question_in.play(0),this.twg_question_in.once(egret.Event.COMPLETE,function(){t.touchChildren=!0,t.wordIdx=0,t.lastTime=0,t.lastIdx=0,egret.startTick(t.loop,t)},this)},e.prototype.startGame=function(){this.twg_question_in.play(0),this.twg_question_in.stop(),this.initQuestion(),this.questionIdx=0,this.nextQuestion(),Music.playBg("game2")},e.prototype.loop=function(t){if(!this.lastTime||t-this.lastTime>this.optDelay){this.lastTime=t;var e=this.questionList[this.questionIdx],n=Math.floor(3*Math.random()),i=Math.random()>.25,o=new Game2Candy(i?e.rightList[this.lastIdx]:e.wrongList[n]);o.x=(o.width+200)*n+30,o.y=-o.height,o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClickOpt,this),this.group_view.addChild(o),i&&(this.lastIdx++,3===this.lastIdx&&(this.lastIdx=0))}for(var r=[],a=0;a<this.group_view.numChildren;a++){var o=this.group_view.getChildAt(a);o.y+=this.moveStep,o.y>this.group_view.height&&r.push(o)}for(var s=function(t){t.touchChildren=t.touchEnabled=!1,egret.Tween.get(t).to({alpha:0},200).call(function(){GFunction.removeFromParent(t)})},l=0,h=r;l<h.length;l++){var o=h[l];s(o)}return!1},e.prototype.waitTween=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e){t.call(e)})]})})},e.prototype.wait=function(t){return __awaiter(this,void 0,void 0,function(){var e=this;return __generator(this,function(n){return[2,new Promise(function(n){egret.setTimeout(n,e,t)})]})})},e.prototype.onClickOpt=function(t){return __awaiter(this,void 0,void 0,function(){var e,n,i,o,r,a,s,r,a;return __generator(this,function(l){switch(l.label){case 0:return this.touchChildren=!1,Music.play("dianji"),e=t.currentTarget,n=this["word"+this.wordIdx],i=this.questionList[this.questionIdx],o=e.localToGlobal(e.width/2,e.height/2),e.labIdx!=i.rightList[this.wordIdx]?[3,6]:(e.anchorOffsetX=e.width/2,e.anchorOffsetY=e.height/2,e.x=o.x,e.y=o.y,this.addChild(e),this.frog.waitPlay("right","normal"),[4,this.waitTween(egret.Tween.get(e).to({x:1608,y:455,scaleX:.4,scaleY:.4},200,egret.Ease.sineIn))]);case 1:return l.sent(),[4,this.waitTween(egret.Tween.get(e).to({alpha:0},150))];case 2:return l.sent(),e.group.localToGlobal(e.bg.x,e.bg.y,o),GFunction.removeFromParent(e),r=new eui.Image,r.source=e.lab.source,r.anchorOffsetX=e.lab.width/2,r.anchorOffsetY=e.lab.height/2,r.x=o.x,r.y=o.y,this.addChild(r),a=n.lab.localToGlobal(),[4,this.waitTween(egret.Tween.get(r).to({x:a.x,y:a.y},200,egret.Ease.sineIn))];case 3:return l.sent(),GFunction.removeFromParent(r),Music.play("right"),n.onRight(e.labIdx),this.wordIdx++,this.wordIdx!=i.rightList.length?[3,5]:[4,this.wait(1e3)];case 4:l.sent(),egret.stopTick(this.loop,this),this.questionIdx++,this.nextQuestion(),l.label=5;case 5:return[3,8];case 6:return this.frog.waitPlay("wrong","normal"),s=DragonBone.create("smork","smoke"),s.setPos(o.x,o.y),this.group_bg.addChild(s.display),s.waitPlay("smoke").then(function(){s.destroy()}),GFunction.removeFromParent(e),r=new eui.Image,r.source=e.lab.source,r.anchorOffsetX=e.lab.width/2,r.anchorOffsetY=e.lab.height/2,r.x=o.x,r.y=o.y,this.addChild(r),a=n.lab.localToGlobal(),[4,this.waitTween(egret.Tween.get(r).to({x:a.x,y:a.y},200,egret.Ease.sineIn))];case 7:l.sent(),GFunction.removeFromParent(r),Music.play("wrong"),n.onWrong(e.labIdx),l.label=8;case 8:return this.touchChildren=!0,[2]}})})},e}(eui.Component);__reflect(Game2.prototype,"Game2");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,n){function i(i){e.call(n,i,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?i(o):RES.getResAsync(t,i,this)}else RES.getResByUrl(t,i,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this);var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t=this;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),Manager.init(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(e){var n=DragonBone.create("dianji","dianji");n.setPos(e.stageX,e.stageY),n.setParent(t.stage),n.waitPlay("newAnimation").then(function(){n.destroy()})},this),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("loading")];case 3:return n.sent(),t=new LoadingUI,this.stage.addChild(t),this.stage.addChild(new XDFLogo),[4,RES.loadGroup("preload",0,t)];case 4:return n.sent(),this.stage.removeChild(t),this.registerFont(),[3,6];case 5:return e=n.sent(),console.error(e),[3,6];case 6:return[2]}})})},e.prototype.registerFont=function(){egret.registerFontMapping("fzcy","resource/assets/font/fzcy.TTF")},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,n){var i=new eui.Theme("resource/default.thm.json",t.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){e(null)},t)})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,n,i){function o(t){e.call(i,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),n.call(i))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(i,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,n){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(i,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var l=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(i,generateJSON.paths[t])},this):RES.getResByUrl(l,function(n){window.JSONParseClass.setData(n),egret.callLater(function(){e.call(i,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(i,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var DialogBox=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.text="",e.wordNum=10,e}return __extends(e,t),e.prototype.init=function(t,e){var n=this;void 0===t&&(t=!0),void 0===e&&(e=!0),this.isLeft=t,this.isTop=e,this.tips=DragonBone.create("duihua",this.isLeft?"L_s":"R_s",{parent:this}),this.tips.play("normal"),this.tips.setScale(1,e?1:-1),this.tips.display.touchEnabled=!0,this.tips.display.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onClick,this),this.qipao=DragonBone.create("duihua",this.isLeft?"L":"R",{parent:this}),this.qipao.setScale(1,e?1:-1),this.qipao.display.visible=!1,this.qipao.display.touchEnabled=!0,this.qipao.display.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){n.qipao.display.touchEnabled=!1,n.clickText&&n.clickText()},this);var i=new eui.Group;i.right=i.bottom=0;var o=new eui.Image;o.texture=RES.getRes("duihua_bg_png"),o.left=o.right=o.top=o.bottom=0,o.scale9Grid=new egret.Rectangle(220,76,30,20),i.anchorOffsetX=o.width-77,i.anchorOffsetY=o.height,i.addChild(o),this.slotText=new eui.Label,this.slotText.lineSpacing=10,this.slotText.verticalAlign="middle",this.slotText.left=30,this.slotText.right=30,this.slotText.top=20,this.slotText.bottom=40,this.slotText.style="dialog",i.addChild(this.slotText),this.slotGroup=new eui.Group,this.slotGroup.width=378,this.slotGroup.height=207,this.slotGroup.addChild(i),this.qipao.setSlot("qipao",this.slotGroup),this.updateText()},e.prototype.onClick=function(){var t=this;this.tips.display.touchEnabled=!1,this.tips.waitPlay("click").then(function(){t.showText()})},e.prototype.showText=function(t){void 0===t&&(t=!0),this.tips.display.visible=!1,this.qipao.display.visible=!0,t&&this.qipao.play("in",1),this.clickTips&&this.clickTips()},e.prototype.updateText=function(t,e,n){t&&(this.text=t),null!=e&&(this.wordNum=e),this.slotText.scaleX=this.isLeft?1:-1,this.slotText.scaleY=this.isTop?1:-1,-1==this.text.indexOf("\n")&&(this.text=TextManager.formateText(this.text,this.wordNum||10,!1)),this.slotText.text=this.text,n&&(this.slotText.textFlow=n),-1==this.text.indexOf("\n")?this.slotText.textAlign="center":this.slotText.textAlign="left",this.reset()},e.prototype.reset=function(){this.tips.play("normal"),this.tips.display.visible=!0,this.tips.display.touchEnabled=!0,this.qipao.display.visible=!1,this.qipao.display.touchEnabled=!0,this.slotGroup.anchorOffsetX=this.slotGroup.width/2,this.slotGroup.anchorOffsetY=this.slotGroup.height/2},e}(eui.Component);__reflect(DialogBox.prototype,"DialogBox");var XDFLogo=function(t){function e(){return t.call(this,"_xdf_logo__png")||this}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.touchEnabled=!1,this.x=0,this.y=1080-this.height},e}(eui.Image);__reflect(XDFLogo.prototype,"XDFLogo");var City=function(t){function e(){var e=t.call(this)||this;return e.talkList=[{obj:"player",text:"我是果果，昨天我收到一本署名只有字母S的书，他是谁呢？我们一起寻找答案吧！"},{obj:"player",text:"前面有一条脏兮兮的小狗，看着好可怜，我们帮他洗洗澡吧。"},{obj:"dog",text:"汪！汪！"},{obj:"player",text:"疑，得到了一本书，\nHAMlet，16世纪来自\n英国，他是谁呢？"},{obj:"dog",text:"汪！汪！"},{obj:"player",text:"前面有一个池塘，那里有一只青蛙，回答他的问题我才能过去。"},{obj:"player",text:"终于过来了，真的是太惊险了，得到了一张照片！"},{obj:"player",text:"原来他是莎士比亚呀！"}],e.dialogInfo={player:{left:!1,x:200,y:-550},frog:{left:!0,x:-150,y:-250},dog:{left:!0,x:-150,y:-250}},e.skinName=skins.CitySkin,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.frog=DragonBone.create("game2_qingwa","wawa",{parent:this.group_frog,animation:"normal"}),this.frog.setScale(.75),this.dog=DragonBone.create("game1_dogxizao","dog",{parent:this.group_dog,animation:"normal"}),this.dog.setScale(.5),this.player=DragonBone.create("aidi","aidi",{parent:this.group_player}),this.finger=DragonBone.create("finger","shouzhi",{parent:this,animation:"shouzhi"}),this.finger.display.visible=!1,this.initDialog("player"),this.initDialog("dog"),this.startGame()},e.prototype.initDialog=function(t){this["dialog_"+t]=new DialogBox,this["dialog_"+t].init(this.dialogInfo[t].left),this["dialog_"+t].x=this.dialogInfo[t].x,this["dialog_"+t].y=this.dialogInfo[t].y,this["dialog_"+t].visible=!1,this["group_"+t].addChild(this["dialog_"+t])},e.prototype.startGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return Music.playBg("city"),this.twg_0.play(0),this.twg_1.stop(),this.play0(),[2]})})},e.prototype.play0=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.dog.play("normal"),[4,this.playTwg(0)];case 1:return t.sent(),[4,this.playTalk(0)];case 2:return t.sent(),[4,this.playTalk(1)];case 3:return t.sent(),[4,this.playTalk(2)];case 4:return t.sent(),[4,this.fingerTips(this.dog.display,0,-200)];case 5:return t.sent(),Manager.showGame1(),[2]}})})},e.prototype.play1=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.dog.play("clean"),[4,this.playTalk(3)];case 1:return t.sent(),[4,this.playTalk(4,!0,"clean","talk_2")];case 2:return t.sent(),[4,this.playTwg(1)];case 3:return t.sent(),[4,this.playTalk(5)];case 4:return t.sent(),[4,this.fingerTips(this.frog.display,0,-100)];case 5:return t.sent(),Manager.showGame2(),[2]}})})},e.prototype.play2=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.playTwg(2)];case 1:return t.sent(),Manager.showEnd(),[4,this.playTalk(6,!0)];case 2:return t.sent(),[4,this.playTalk(7,!0)];case 3:return t.sent(),[2]}})})},e.prototype.playTwg=function(t){var e=this;return new Promise(function(n){e.player.play("walk"),e["twg_"+t].play(0),e["twg_"+t].once(egret.Event.COMPLETE,function(){e.player.play("normal"),n(null)},e)})},e.prototype.playTalk=function(t,e,n,i){var o=this;return void 0===e&&(e=!1),void 0===n&&(n="normal"),void 0===i&&(i="talk"),new Promise(function(r){var a=o.talkList[t],s=o[a.obj];if(e)s.play(i),Music.play(t+"").then(function(){s.play(n),r(null)});else{var l=o["dialog_"+a.obj];s.play(n),l.visible=!0,l.updateText(a.text),l.clickTips=function(){return __awaiter(o,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return s.play(i),[4,Music.play(t+"")];case 1:return e.sent(),s.play(n),h(),[2]}})})};var h=function(){l.clickText=null,l.visible=!1,s.play(n),Music.stop(t+""),r(null)};l.clickText=h,l.showText()}})},e.prototype.fingerTips=function(t,e,n){var i=this;return void 0===e&&(e=0),void 0===n&&(n=0),new Promise(function(o){var r=t.parent.localToGlobal(t.x,t.y);i.finger.setPos(r.x+e,r.y+n),i.finger.display.visible=!0,i.once(egret.TouchEvent.TOUCH_TAP,function(){i.finger.display.visible=!1,o(null)},i)})},e}(eui.Component);__reflect(City.prototype,"City");var Game1=function(t){function e(){var e=t.call(this)||this;return e.list=[],e.questionInfo=[0,1,2,3],e.questionList=[],e.skinName="skins.Game1Skin",e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.clean,this),this.lab_question.textFlow=TextManager.changeTxtStyle("选择(正确的毛巾)给我洗澡吧!",{textColor:16736325}),this.dog=DragonBone.create("game1_dogxizao","dog2",{parent:this.group_bg}),this.bofang=DragonBone.create("game1_bofang","btn",{parent:this.group_sound}),this.bofang.display.touchEnabled=!0,this.bofang.display.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickSound,this);for(var e=0;4>e;e++){var n=DragonBone.create("game1_dogxizao","maojin",{parent:this["group_mj"+e]});n.display.touchEnabled=!0,n.setSlot("cow",new Game1Item(e)),n.setSlot("T_cow",null),n.display.name=e+"",e>1&&(n.display.scaleX=-1),n.display.touchEnabled=!0,n.display.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClickItem,this),this.list.push(n)}this.startGame()},e.prototype.clean=function(){Music.playBg("city")},e.prototype.startGame=function(){Music.playBg("game1"),this.twg_in.play(0),this.twg_in.stop(),this.questionList=GFunction.randomArrOrder(this.questionInfo),this.questionIdx=0,this.nextQuestion()},e.prototype.nextQuestion=function(){return __awaiter(this,void 0,void 0,function(){var t,e,n;return __generator(this,function(i){switch(i.label){case 0:if(this.questionIdx==this.questionList.length)return GFunction.removeFromParent(this),Manager.city.play1(),[2];for(this.lab_question_idx.textFlow=TextManager.changeTxtStyle("("+(this.questionIdx+1)+")/4",{textColor:16736325}),this.touchChildren=!1,this.bofang.display.visible=!1,this.twg_in.play(0),t=0,e=this.list;t<e.length;t++)n=e[t],n.play("in",1);return[4,this.dog.play("in",1)];case 1:return i.sent(),this.dog.play("normal"),0!=this.questionIdx?[3,3]:[4,Music.play("game1_tips")];case 2:i.sent(),i.label=3;case 3:return this.bofang.display.visible=!0,[4,this.bofang.play("normal",1)];case 4:return i.sent(),this.bofang.goStart("normal"),Music.play("game1_q"+this.questionList[this.questionIdx]),this.touchChildren=!0,[2]}})})},e.prototype.onClickItem=function(t){return __awaiter(this,void 0,void 0,function(){var e,n;return __generator(this,function(i){switch(i.label){case 0:return this.touchChildren=!1,Music.play("dianji"),e=t.currentTarget,n=e.db,e.name!=this.questionList[this.questionIdx]+""?[3,3]:(Music.play("right"),[4,n.waitPlay("right")]);case 1:return i.sent(),[4,this.dog.waitPlay("right1","normal")];case 2:return i.sent(),this.questionIdx++,this.nextQuestion(),[3,5];case 3:return Music.play("wrong"),n.waitPlay("wrong"),[4,this.dog.waitPlay("wrong","normal")];case 4:i.sent(),this.touchChildren=!0,i.label=5;case 5:return[2]}})})},e.prototype.onClickSound=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return this.bofang.display.touchEnabled=!1,Music.play("dianji"),[4,this.bofang.play("normal",1)];case 1:return t.sent(),this.bofang.goStart("normal"),Music.play("game1_q"+this.questionList[this.questionIdx]),this.bofang.display.touchEnabled=!0,[2]}})})},e}(eui.Component);__reflect(Game1.prototype,"Game1");var Game1Item=function(t){function e(e){var n=t.call(this)||this;return n.idx=e,n.skinName="skins.Game1ItemSkin",n.width=203,n.height=163,n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.idx>1&&(this.group.scaleX=-1),this.bg.source="game1_opt"+this.idx+"_png",this.lab.source="game1_lab"+this.idx+"_png"},e}(eui.Component);__reflect(Game1Item.prototype,"Game1Item");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.LoadingSkin,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.dong=DragonBone.create("aidi","aidi_1"),this.dong.setParent(this.dongGroup),this.dong.setScale(.5),this.dong.play("walk"),this.dong.setTimeScale(2)},e.prototype.onProgress=function(t,e){this.lab.text="loading "+Math.floor(t/e*100).toString()+"%"},e}(eui.Component);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Game2Candy=function(t){function e(e){var n=t.call(this)||this;return n.labIdx=e,n.skinName=skins.Game2CandySkin,n}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this);var e=Math.floor(5*Math.random());this.bg.source="game2_opt"+e+"_png",this.lab.source="game2_"+this.labIdx+"_lab"+e+"_png",egret.Tween.get(this.group,{loop:!0}).set({rotation:-30}).to({rotation:30},200).to({rotation:-30},200)},e}(eui.Component);__reflect(Game2Candy.prototype,"Game2Candy");var Game2QuestionItem=function(t){function e(){var e=t.call(this)||this;return e.skinName=skins.Game2QuestionItemSkin,e}return __extends(e,t),e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.onReset()},e.prototype.onRight=function(t){this.bg.source="game2_bg3_png",this.lab.source="game2_r_lab"+t+"_png"},e.prototype.onWrong=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return this.bg.source="game2_bg2_png",this.lab.source="game2_w_lab"+t+"_png",[4,Effect.shock(this.group)];case 1:return e.sent(),this.onReset(),[2]}})})},e.prototype.onReset=function(){this.bg.source="game2_bg1_png",this.lab.source=null},e}(eui.Component);__reflect(Game2QuestionItem.prototype,"Game2QuestionItem");var End=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.EndSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),this.btn_restart.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Music.play("dianji"),GFunction.removeFromParent(e),Manager.showStart()},this),this.btn_restart.visible=!1;var n=DragonBone.create("end","end",{parent:this.group});n.waitPlay("in","normal"),egret.setTimeout(function(){e.btn_restart.visible=!0,egret.Tween.get(e.btn_restart).to({alpha:1},300)},this,2210)},e}(eui.Component);__reflect(End.prototype,"End");var Start=function(t){function e(){var e=t.call(this)||this;return e.skinName="skins.StartSkin",e}return __extends(e,t),e.prototype.childrenCreated=function(){var e=this;t.prototype.childrenCreated.call(this),egret.Tween.get(this.btn_start,{loop:!0}).to({scaleX:1.25,scaleY:1.25},550).to({scaleX:1,scaleY:1},400),this.btn_start.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){Music.play("dianji"),egret.Tween.removeTweens(e.btn_start),GFunction.removeFromParent(e),Manager.showCity()},this),this.btn_start.visible=!1;var n=DragonBone.create("all","startgame",{parent:this.group});n.waitPlay("in","normal"),egret.setTimeout(function(){e.btn_start.visible=!0,egret.Tween.get(e.btn_start).to({alpha:1},300)},this,2210)},e}(eui.Component);__reflect(Start.prototype,"Start");var Manager=function(){function t(){}return t.init=function(t){this.main=t,this.showStart()},t.showStart=function(){this.main.addChild(new Start)},t.showCity=function(){this.city=new City,this.main.addChild(this.city)},t.showGame1=function(){this.main.addChild(new Game1)},t.showGame2=function(){this.main.addChild(new Game2)},t.showEnd=function(){this.main.addChild(new End)},t}();__reflect(Manager.prototype,"Manager");var DragonBone=function(){function t(e,n,i){dragonBones.EgretFactory.factory.getDragonBonesData(e)?this.display=dragonBones.EgretFactory.factory.buildArmatureDisplay(n,e):(t.addToFactory(e,i),this.display=dragonBones.EgretFactory.factory.buildArmatureDisplay(n,e)),this.display.db=this}return t.addToFactory=function(t,e){this._factory||(this._factory=dragonBones.EgretFactory.factory);var n=RES.getRes(t+"_ske_json");if(n){n.name=t,this._factory.parseDragonBonesData(n);var i,o;if(e)for(var r=0;e>r;r++)i=RES.getRes(t+"_tex_"+r+"_json"),o=RES.getRes(t+"_tex_"+r+"_png"),i.name=t,this._factory.parseTextureAtlasData(i,o);else i=RES.getRes(t+"_tex_json"),o=RES.getRes(t+"_tex_png"),i.name=t,this._factory.parseTextureAtlasData(i,o)}},t.create=function(e,n,i){void 0===i&&(i={});var o=new t(e,n,i.textureCount);return null!=i.parent&&o.setParent(i.parent),null!=i.x&&null!=i.y&&o.setPos(i.x,i.y),null!=i.animation&&o.play(i.animation,0|i.playTimes),null!=i.scale&&o.setScale(i.scale),null!=i.timeScale&&o.setTimeScale(i.timeScale),o},t.prototype.destroy=function(){this.display&&this.display.parent&&this.display.parent.removeChild(this.display),this.stop()},t.prototype.waitPlay=function(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){switch(n.label){case 0:return[4,this.play(t,1)];case 1:return n.sent(),e&&this.play(e,0),[2]}})})},t.prototype.play=function(t,e){var n=this;return void 0===e&&(e=-1),new Promise(function(i){n.display&&(n.display.animation.reset(),n.display.animation.play(t,e),1==e?n.display.once(egret.Event.LOOP_COMPLETE,function(){i(null)},n):i(null))})},t.prototype.stop=function(){this.display&&this.display.animation.stop()},t.prototype.setScale=function(t,e){void 0===e&&(e=t),this.display&&(this.display.scaleX=t,this.display.scaleY=e)},t.prototype.setParent=function(t,e){this.display&&(null!=e?t.addChildAt(this.display,e):t.addChild(this.display))},t.prototype.setPos=function(t,e){this.display&&(this.display.x=t,this.display.y=e)},t.prototype.setTimeScale=function(t){this.display&&(this.display.animation.timeScale=t)},t.prototype.setSlot=function(t,e,n,i){if(void 0===n&&(n=0),void 0===i&&(i=0),this.display){var o=this.display.armature.getSlot(t);if(!o)return console.error("can't find slot:",t);if(e)if(this.setSlotDisplayIndx(t,0),"string"==typeof e){var r=new egret.Bitmap;r.texture=RES.getRes(e),r.anchorOffsetX=r.width/2+n,r.anchorOffsetY=r.height/2+i,o.display=r}else e.anchorOffsetX=e.width/2+n,e.anchorOffsetY=e.height/2+i,o.display=e;else this.setSlotDisplayIndx(t,-1),o.display=e}},t.prototype.setSlotDisplayIndx=function(t,e){if(void 0===e&&(e=0),this.display){var n=this.display.armature.getSlot(t);n&&(n.displayIndex=e)}},t.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0),this.display&&this.display.animation.gotoAndStopByFrame(t,e)},t.prototype.goEnd=function(t){void 0===t&&(t="in");var e=this.display.armature.armatureData.animations[t].frameCount;this.gotoAndStopByFrame(t,e)},t.prototype.goStart=function(t){void 0===t&&(t="in"),this.gotoAndStopByFrame(t,0)},Object.defineProperty(t.prototype,"aabb",{get:function(){return this.display?this.display.armature.armatureData.aabb:new egret.Rectangle(0,0,1920,1080)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultAniName",{get:function(){return this.display?this.display.armature.armatureData.defaultAnimation.name:void 0},enumerable:!0,configurable:!0}),t}();__reflect(DragonBone.prototype,"DragonBone");var Effect;!function(t){function e(t){return new Promise(function(e){var n=30;egret.Tween.removeTweens(t),egret.Tween.get(t).to({x:t.x-n},30).to({x:t.x},30).to({x:t.x+n},30).to({x:t.x},30).to({x:t.x-n},30).to({x:t.x},30).to({x:t.x+n},30).to({x:t.x},30).call(e)})}t.shock=e}(Effect||(Effect={}));var GFunction;!function(t){function e(){return!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)}function n(t){var e=new RegExp("[^\\u4e00-\\u9fa5]");return e.test(t)?!1:!0}function i(t){var e=/^\d+(\.\d+)?$/,n=/^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$/;return e.test(t)||n.test(t)?!0:!1}function o(t){var e=/\d+/;return e.test(t)?!0:!1}function r(t){var e=new Array,n=new Array;n=t.slice();for(var i=0;i<t.length;i++){var o=s(0,n.length-1);e.push(n[o]),n.splice(o,1)}return e}function a(t,e){var n=new Array;n=t.slice();for(var i=new Array,o=0;e>o;o++){var r=s(0,n.length-1);i.push(n[r]),n.splice(r,1)}return i}function s(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function l(t,e,n,i){return t.substring(0,e)+i+t.substring(n)}function h(){var t=[.3,.9,0,0,0,.3,.9,0,0,0,.3,.9,0,0,0,0,0,0,1,0];return new egret.ColorMatrixFilter(t)}function u(t,e){void 0===e&&(e=.8);var n=30,i=30,o=5,r=3,a=!1,s=!1;return new egret.GlowFilter(t,e,n,i,o,r,a,s)}function c(t,e,n){void 0===n&&(n=.8),t.filters=[u(e,n)]}function p(t,e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(n){return c(t,e?65280:16711680),egret.setTimeout(function(){t.filters=[]},this,200),[2]})})}function d(t){return null}function g(t){return JSON.parse(JSON.stringify(t))}function f(t){t.parent&&t.parent.removeChild&&t.parent.removeChild(t)}t.isIos=e,t.isChinese=n,t.isNumber=i,t.haveNumber=o,t.randomArrOrder=r,t.randomNewArr=a,t.getRandomNum=s,t.replaceStrAt=l,t.getGrey=h,t.getFilter=u,t.addFilter=c,t.effectTwingling=p,t.getUrlVal=d,t.copy=g,t.removeFromParent=f}(GFunction||(GFunction={}));var Music=function(){function t(){}return t.play=function(t,e,n){var i=this;return void 0===e&&(e=1),void 0===n&&(n=1),new Promise(function(o){i.soundDic[t]||(i.soundDic[t]={},i.soundDic[t].sound=RES.getRes(t+"_mp3"));var r=i.soundDic[t];return r.sound?(i.stop(t),r.sound.type=egret.Sound.EFFECT,r.channel=r.sound.play(0,e),r.channel.volume=n,void r.channel.addEventListener(egret.Event.SOUND_COMPLETE,o,i)):void o(null)})},t.stop=function(t){var e=this.soundDic[t];e&&e.channel&&(e.channel.stop(),e.linsten&&e.channel.removeEventListener(egret.Event.SOUND_COMPLETE,e.linsten,this))},t.stopAll=function(){for(var t in this.soundDic)this.stop(t)},t.playBg=function(t,e){void 0===e&&(e=.3);var n=RES.getRes(t+"_mp3");n&&(this.bgVolume=e,this.stopBg(),this.bgSound={sound:n},this.bgSound.sound.type=egret.Sound.MUSIC,this.bgSound.channel=this.bgSound.sound.play(0,0),this.bgSound.channel.volume=this.bgVolume)},t.stopBg=function(){this.bgSound&&this.bgSound.channel&&(this.bgSound.channel.stop(),this.bgSound.channel=null)},t.pauseBg=function(){this.bgSound&&this.bgSound.channel&&(this.bgPosition=this.bgSound.channel.position,this.bgSound.channel.stop())},t.resumeBg=function(){var t=this;this.bgSound&&this.bgSound.channel&&(this.bgPosition?(this.bgSound.channel=this.bgSound.sound.play(this.bgPosition,1),this.bgSound.channel.volume=this.bgVolume,this.bgSound.channel.once(egret.Event.COMPLETE,function(){t.bgPosition=0,t.bgSound.channel=t.bgSound.sound.play(0,0),t.bgSound.channel.volume=t.bgVolume},this)):(this.bgSound.channel=this.bgSound.sound.play(0,0),this.bgSound.channel.volume=this.bgVolume))},t.soundDic=[],t.bgPosition=0,t}();
__reflect(Music.prototype,"Music");var TextManager=function(){function t(){this.markList=[],this.eventList=[]}return t.prototype.setProp=function(t,e){for(var n in e)t[n]=e[n]},t.prototype.createLabel=function(t,e){var n=new eui.Group,i=new eui.Label(t.text);if(this.setProp(i,e.fontProp),i.horizontalCenter=0,n.addChild(i),n.width=i.width,n.height=i.height,t.pinyin&&e.pinyinProp){var o=new eui.Label(t.pinyin);o.top=-e.pinyinProp.size,o.horizontalCenter=0,this.setProp(o,e.pinyinProp),n.addChild(o)}if(t.mark&&e.markProp){var r=new eui.Label(t.mark);r.top=0,this.setProp(r,e.markProp),n.addChild(r),r.right=-r.width,this.markList.push(r)}return null!=t.color&&(null!=t.event?this.eventList.push({label:i,data:t}):i.textColor=t.color),{box:n,text:t.text,labelData:t}},t.prototype.getLabelDataList=function(t){for(var e=[],n=t.match(/#[a-fA-F\d]{6}\[.+?\]/g)||[],i=t.split(/#[a-fA-F\d]{6}\[.+?\]/g)||[t],o=function(t){var o,r,a=function(t){for(var n=t.match(/\([0-9]*\)/g)||[],i=t.split(/\([0-9]*\)/g)||[t],a=0;a<i.length;a++){for(var s=i[a],l=s.match(/\(\D+?\)/g)||[],h=s.split(/\(\D+?\)/g)||[s],u=0;u<h.length;u++){for(var c=h[u].split(""),p=0,d=c;p<d.length;p++){var g=d[p],f={text:g};null!=o&&(f.color=o,null!=r&&(f.event=r)),e.push(f)}l[u]&&(e[e.length-1].pinyin=l[u].slice(1,l[u].length-1))}n[a]&&(e[e.length-1].mark=n[a].slice(1,n[a].length-1))}};if(a(i[t]),n[t]){o=parseInt(n[t].slice(1,7).replace("#",""),16);var s=n[t].slice(8,n[t].length-1);if(/^\$[0-9]*\$/.test(s)){var l=s.match(/^\$[0-9]*\$/g)[0];r="event:"+l.slice(1,l.length-1),s=s.replace(/^\$[0-9]*\$/g,"")}a(s)}},r=0;r<i.length;r++)o(r);return e},t.prototype.formateTextDataList=function(e,n,i){var o=this.getLabelDataList(e),r=[],a=[],s=0;for(i&&(s+=2);o.length;)if(n>s){var l=o.shift();a.push(l),-1==t.ban.indexOf(l.text)&&s++}else{for(var h=!1;!h;)a.length?(h=t.checkJW(a[a.length-1].text),h||o.unshift(a.pop()),h=t.checkJS(o[0].text),h||o.unshift(a.pop())):h=!0;r.push(a),a=[],s=0}return a.length&&r.push(a),r},t.prototype.bindEvent=function(t){for(var e=this,n=function(n){n.label.textFlow=[{text:n.data.text,style:{href:n.data.event}}],n.label.addEventListener(egret.TextEvent.LINK,function(i){Music.play("dianji");for(var o=0,r=e.eventList;o<r.length;o++){var a=r[o];a.data.event==n.data.event&&(a.label.textFlow=[{text:a.data.text,style:{textColor:a.data.color,href:a.data.event}}])}t.textLinkCb&&t.textLinkCb(+i.text)},i)},i=this,o=0,r=this.eventList;o<r.length;o++){var a=r[o];n(a)}},t.checkJS=function(t){return-1==this.ban_jushou.indexOf(t)},t.checkJW=function(t){return-1==this.ban_juwei.indexOf(t)},t.create=function(e,n){n.wordSpace||(n.wordSpace=6),n.wordNum||(n.wordNum=0),n.lineSpace||(n.lineSpace=0);var i=new t;e.removeChildren();var o=[];if(n.wordNum)o=i.formateTextDataList(n.text.split("\n").join(""),n.wordNum,n.isParagraph);else for(var r=n.text.split("\n"),a=0,s=r;a<s.length;a++){var l=s[a],h=i.getLabelDataList(l);o.push(h)}for(var u=[],c=0,p=o;c<p.length;c++){for(var h=p[c],d=[],g=0,f=h;g<f.length;g++){var y=f[g];d.push(i.createLabel(y,n))}u.push(d)}var v=0,m=0;n.isParagraph&&(m+=2*n.fontProp.size);for(var _=0;_<u.length;_++){for(var d=u[_],w=0,x=0,b=d;x<b.length;x++){var T=b[x],S=T.box,l=T.text;S.x=m,S.y=v,e.addChild(S),m+=S.width+n.wordSpace,w=Math.max(S.height,w)}m=0,v+=w,v+=n.lineSpace}return i.bindEvent(n),u},t.test=function(){var t=new eui.Group;egret.MainContext.instance.stage.addChild(t),this.create(t,{text:"黄梅时#ff0000[节(pinyin)(2)家家雨]，青草池塘处处蛙。有约不来过夜半，闲敲棋子落灯花(3)。黄梅时#ff0000[节(pinyin)(2)家家雨]，青草池塘处处蛙。有约不来过夜半，闲敲棋子落灯花(3)。黄梅时#ff0000[节(pinyin)(2)家家雨]，青草池塘处处蛙。有约不来过夜半，闲敲棋子落灯花(3)。",lineSpace:20,wordSpace:20,wordNum:8,fontProp:{fontFamily:"z2",size:70,textColor:2304047},markProp:{fontFamily:"z2",size:36,textColor:15339276},pinyinProp:{fontFamily:"z3",size:36,textColor:15339276},markList:["约：邀约，邀请。","黄梅时节：农历五月，江南梅子熟了，大都是阴雨绵绵的时候，称为“梅雨季节”，所以称江南雨季为“黄梅时节”。","落灯花：旧时以油灯照明，灯芯烧残，落下来时好像一朵闪亮的小花。落，使……掉落。灯花，灯芯燃尽结成的花状物。"]})},t.formateText=function(t,e,n){var i=t.split(""),o=[],r=[],a=0;for(t.length<e&&(n=!1),n&&(a+=2);i.length;)if(e>a){var s=i.shift();r.push(s),-1==this.ban.indexOf(s)&&a++}else{for(var l=!1;!l;)r.length?(l=this.checkJW(r[r.length-1]),l||i.unshift(r.pop()),l=this.checkJS(i[0]),l||i.unshift(r.pop())):l=!0;o.push(r),r=[],a=0}r.length&&o.push(r);var h="";n&&(h+="       ");for(var u=0;u<o.length;u++){r=o[u];for(var c=0;c<r.length;c++)h+=r[c];u<o.length-1&&(h+="\n")}return h},t.changeTxtStyle=function(t,e,n){void 0===e&&(e={}),void 0===n&&(n=/\(.+?\)/g);for(var i=[],o=t.match(n)||[],r=t.split(n)||[t],a=0;a<r.length;a++){var s=r[a];i.push({text:s});var l=o[a];l&&(l=l.slice(1,l.length-1),i.push({text:l,style:e}))}return i},t.changeTxtColors=function(t){for(var e=[],n=t.match(/#[a-fA-F\d]{6}\[.+?\]/g)||[],i=t.split(/#[a-fA-F\d]{6}\[.+?\]/g)||[t],o=0;o<i.length;o++){var r=i[o];e.push({text:r});var a=n[o];a&&e.push({text:a.slice(8,a.length-1),style:{textColor:parseInt(a.slice(1,7).replace("#",""),16)}})}return e},t.changeTxtTouch=function(t,e){void 0===e&&(e=/\$.+?\$/g);for(var n=[],i=t.match(e)||[],o=t.split(e)||[t],r=0,a=0;a<o.length;a++){var s=o[a];n.push({text:s});var l=i[a];l&&(l=l.slice(1,l.length-1),n.push({text:l,style:{href:"event:"+r}}),r++)}return n},t.ban_jushou=["、","，","。","”","’","》",">","？","！","：","·","_","）"],t.ban_juwei=["“","‘","《","<","（"],t.ban=["(",")","$"],t}();__reflect(TextManager.prototype,"TextManager");